riot.tag2("pagination",'<ul if="{theme==\'long\'}" class="pagination"> <li if="{totalMessage}" class="disabled total"><a>{totalMessage}</a></li> <li if="{has_first}" class="first"><a href="#" onclick="{go(1)}"><pagination-raw content="{first}"></pagination-raw></a></li> <li if="{has_prev}" class="prev"><a href="#" onclick="{go(page-1)}"><pagination-raw content="{prev}"></pagination-raw></a></li> <li class="{page:true, active:p==page}" each="{p in pages}"><a href="#" onclick="{go(p)}">{p}</a></li> <li if="{has_next}" class="next"><a href="#" onclick="{go(page+1)}"><pagination-raw content="{next}"></pagination-raw></a></li> <li if="{has_last}" class="last"><a href="#" onclick="{go(totalPages)}"><pagination-raw content="{last}"></pagination-raw></a></li> <li if="{refresh}" class="refresh"><a href="#" onclick="{go(page, true)}"><pagination-raw content="{refresh}"></pagination-raw></a></li> </ul> <div if="{theme==\'long\' && buttons.length>0}" class="pull-right {btn_group_class}"> <button each="{btn in buttons}" data-is="pagination-button" btn="{btn}"></button> </div> <div if="{theme==\'simple\'}" class="{btn_group_class} pull-left pagination"> <a class="btn btn-default" disabled="{totalPages<=1 || page==1}" onclick="{go(1)}" title="{first_title}"><pagination-raw content="{first}"></pagination-raw></a> <a class="btn btn-default" disabled="{!has_prev}" onclick="{go(page-1)}" title="{prev_title}"><pagination-raw content="{prev}"></pagination-raw></a> <a class="btn btn-default page_input">第 <input type="text" onkeypress="{page_input_click}" riot-value="{page}" style="width:40px"> 页/共{totalPages}页</input></a> <div class="btn-group dropup page-limits"> <div class="dropdown"> <button class="btn btn-default" type="button" data-toggle="dropdown"> 每页 {limit} 条 <span class="caret"></span> </button> <ul class="dropdown-menu"> <li each="{p in limits}"><a href="#" onclick="{change_limit(p)}">{p}</a></li> </ul> </div> </div> <a class="btn btn-default" disabled="{!has_next}" onclick="{go(page+1)}" title="{next_title}"><pagination-raw content="{next}"></pagination-raw></a> <a class="btn btn-default" disabled="{totalPages<=1 || page==totalPages}" onclick="{go(totalPages)}" title="{last_title}"><pagination-raw content="{last}"></pagination-raw></a> <a if="{refresh}" class="btn btn-default" onclick="{go(page, true)}" title="{refresh_title}"><pagination-raw content="{refresh}"></pagination-raw></a> </div> <div if="{theme==\'simple\' && buttons.length>0}" class="pull-left {btn_group_class}"> <button each="{btn in buttons}" data-is="pagination-button" btn="{btn}"></button> </div> <p if="{theme==\'simple\'}" class="pull-right message">{totalMessage}</p>','pagination .pagination,[data-is="pagination"] .pagination{margin:0px;margin-right:5px;} pagination .pagination>li.disabled>a,[data-is="pagination"] .pagination>li.disabled>a{color:#999;} pagination .page_input,[data-is="pagination"] .page_input{padding:0px 12px; line-height: 34px; height:34px;} pagination .page_input input,[data-is="pagination"] .page_input input{height:20px;line-height:20px;margin:0;} pagination .message,[data-is="pagination"] .message{line-height: 34px;line:34px;margin:0 auto;} pagination .btn.disabled,[data-is="pagination"] .btn.disabled{cursor:not-allowed;} pagination .pagination .page-limits,[data-is="pagination"] .pagination .page-limits{} pagination .pagination .page-limits button,[data-is="pagination"] .pagination .page-limits button{border-radius: 0px;}',"",function(t){var a=this;this.observable=t.observable,this.total=t.total,this.theme=t.theme||"simple",this.page=t.page||1,this.limit=t.limit||10,this.data=t.data,this.limits=t.limits||[10,20,30,40,50],this.buttons=t.buttons||[],this.size=t.size||10,this.btn_group_class=t.btn_group_class||"btn-group",this.pages=[],this.onpage=t.onPage||function(){return a.data.load(a.get_url(),function(t){return a.total=t.total,t.rows})},this.onlimit=t.onlimit,this.onpagechanged=t.onpagechanged,this._totalMessage=t.totalMessage||"共 $pages 页 / $records 条记录",this.prev=t.prev||"上一页",this.prev_title=t.prev_title||this.prev,this.has_prev=!1,this.next=t.next||"下一页",this.next_title=t.next_title||this.next,this.has_next=!1,this.first=t.first||"首页",this.first_title=t.first_title||this.first,this.has_first=!1,this.last=t.last||"尾页",this.last_title=t.last_title||this.last,this.has_last=!1,this.refresh=t.refresh||"刷新",this.refresh_title=t.refresh_title||this.refresh,"simple"==this.theme&&(this._totalMessage=t.totalMessage||"共 $records 条记录",this.prev=t.prev||'<i class="fa fa-backward"></i>',this.next=t.next||'<i class="fa fa-forward"></i>',this.first=t.first||'<i class="fa fa-fast-backward"></i>',this.last=t.last||'<i class="fa fa-fast-forward"></i>',this.refresh=t.refresh||'<i class="fa fa-refresh"></i>'),this.on("update",function(){this.url=t.url,this.total=t.total,this.page=t.page,this.limit=t.limit,this.show()}),this.get_url=function(t){return get_url(a.url,{page:t||a.page,limit:a.limit})},this.push_url=function(t){history&&history.pushState&&history.pushState(null,null,t)},this.go_page=function(i,e){a.page;0!=a.totalPages&&(!e&&(i<=0||i>a.totalPages||a.page===i)||(this.observable.trigger("beforepage",i),t.onbeforepage&&"function"==typeof t.onbeforepage&&!t.onbeforepage.call(a,i)||(a.page=i,a.onpage&&"function"==typeof a.onpage?$.when(a.onpage.call(a,i)).done(function(t){a.show(i),a.onpagechanged&&a.onpagechanged.call(a,i)}):a.show())))},this.change_limit=function(t){return f=function(i){i.preventDefault(),a.limit=t,a.onlimit&&a.onlimit(a.limit)},f},this.go=function(t,i){return f=function(e){e.preventDefault(),a.go_page(t,i)},f},this.page_input_click=function(t){if(13==t.keyCode){t.preventDefault();var a=parseInt($(t.target).val());a&&this.go_page(a)}},this.show=function(i){a.total=t.total||a.total,a.page=i||a.page,a.totalPages=parseInt(a.total/a.limit),a.total%a.limit>0&&a.totalPages++,a._totalMessage&&(a.totalMessage=a._totalMessage.replace("$pages",a.totalPages),a.totalMessage=a.totalMessage.replace("$records",a.total));var i=a.page,e=a.size/2;a.size%2>0&&(e=(a.size+1)/2);var n=1;i>=1&&i<=a.totalPages&&i>=e&&(n=a.totalPages-i>=e?i-(e-1):Math.max(a.totalPages-a.size+1,1)),a.pages=[];for(var s=n,o=Math.min(n+a.size-1,a.totalPages);s<=o;s++)a.pages.push(s);a.size>1?(a.has_prev=a.prev&&i>1,a.has_next=a.next&&i<a.totalPages,a.has_first=1!==n,a.has_last=a.pages[a.pages.length-1]<a.totalPages):(a.has_prev=!1,a.has_next=!1,a.has_last=!1,a.has_first=!1)}}),riot.tag2("pagination-raw","<span></span>","","",function(t){this.on("mount",function(){this.root.innerHTML=t.content}),this.on("update",function(){this.root.innerHTML=t.content})}),riot.tag2("pagination-button",'<i if="{opts.btn.icon}" class="{opts.btn.icon}"></i> <span>{opts.btn.label}</span>',"",'class="{opts.btn.class}" id="{opts.btn.id}" type="button" disabled="{opts.btn.disabled && opts.btn.disabled(btn)}" onclick="{opts.btn.onclick}"',function(t){});